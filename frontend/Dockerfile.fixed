FROM node:16-alpine

WORKDIR /app

COPY package.json ./

# Remove problematic @mui/lab dependency
RUN sed -i 's/"@mui\/lab": ".*"/"@mui\/lab": "^5.0.0-alpha.53"/g' package.json || true

# Install dependencies
RUN npm install --legacy-peer-deps

# Copy the rest of the application
COPY . .

# Fix the problematic @mui/lab imports
RUN sed -i '/from "@mui\/lab";/d' src/components/AdminDashboard/AdminDashboard.jsx || true
RUN sed -i '/Timeline,/d' src/components/AdminDashboard/AdminDashboard.jsx || true
RUN sed -i '/TimelineItem,/d' src/components/AdminDashboard/AdminDashboard.jsx || true
RUN sed -i '/TimelineSeparator,/d' src/components/AdminDashboard/AdminDashboard.jsx || true
RUN sed -i '/TimelineConnector,/d' src/components/AdminDashboard/AdminDashboard.jsx || true
RUN sed -i '/TimelineContent,/d' src/components/AdminDashboard/AdminDashboard.jsx || true
RUN sed -i '/TimelineDot/d' src/components/AdminDashboard/AdminDashboard.jsx || true

EXPOSE 5173

CMD ["npm", "run", "dev", "--", "--host"] 